{% extends "base.html" %}
{% block title %}Usuario · {{ user.email }}{% endblock %}
{% block content %}
<div class="card p-3 shadow-sm">
  <h5 class="mb-2">{{ user.full_name or user.email }}</h5>
  <div class="small text-muted mb-3">{{ user.email }}</div>

  <p class="mb-1">Ejecuciones usadas: <strong>{{ used }}</strong></p>
  <p class="mb-3">Límite vigente: <strong>{{ user.exec_limit if user.exec_limit is not none else '—' }}</strong></p>

  <form class="row g-3" method="post" action="{{ url_for('admin.set_user_membership', email=user.email) }}">
    <div class="col-md-4">
      <label class="form-label">Membresía</label>
      <select name="membership_id" class="form-select">
        <option value="">(Sin membresía)</option>
        {% for m in levels %}
          <option value="{{ m.id }}" {% if user.membership_id == m.id %}selected{% endif %}>
            {{ m.title }} ({{ m.max_execs }})
          </option>
        {% endfor %}
      </select>
    </div>
    <div class="col-md-4">
      <label class="form-label">Override de límite (opcional)</label>
      <input type="number" min="0" class="form-control" name="exec_limit_override"
             value="{{ user.exec_limit_override if user.exec_limit_override is not none }}">
      <div class="form-text">Si se define, ignora el límite del nivel.</div>
    </div>
    <div class="col-md-4 d-flex align-items-end">
      <button class="btn btn-primary">Guardar cambios</button>
    </div>
  </form>
</div>
{% endblock %}
